<p>Many templates have a need to present repeating data. Often the precise number of repeated answers will vary from data entry to data entry. You can add repeatable sets of fields to a Form by using a Page Group with the Repeatable property ticked on.</p><p>There are two ways to output the answers for these repeatable fields in your template:</p><ol><li><p>Repeat rows in a Word table or Excel worksheet using the special <strong>{{!REPEATROW}}</strong> placeholder</p></li><li><p>Define the section of the template to output for each repeat.This uses the special <strong>{{!REPEATSTART}}</strong> and <strong>{{!REPEATEND}}</strong> placeholders.</p></li></ol><p>These options give you the flexibility to handle repeating data the way you want.</p><p>For downloadable examples of repeatable data templates, jump to the end of this article.</p><h3 id="RepeatingData-UsingtheRepeatRowsApproach"><strong>Using the Repeat Rows Approach</strong></h3><p>Often it is useful to place repeating data in a Word table or Excel worksheet. You can create a repeatable listing by adding a special {{!REPEATROW}} placeholder into the very first cell of the row you want to repeat.</p><p>The system will then repeat the enclosing row and will replace all placeholders found within the relevant data values.</p><p>For example in a Word table:</p><div class="table-wrap"><table data-layout="default" data-local-id="84ca19e9-a13a-4a33-915b-cc7ebb6145c4" class="confluenceTable"><colgroup><col style="width: 226.67px;"/><col style="width: 226.67px;"/><col style="width: 226.67px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>FIRST NAME</strong></p></th><th class="confluenceTh"><p><strong>LAST NAME</strong></p></th><th class="confluenceTh"><p><strong>GENDER</strong></p></th></tr><tr><td data-highlight-colour="transparent" class="confluenceTd"><p>{{!REPEATROW}}{{firstname}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p>{{lastname}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p>{{gender}}</p></td></tr></tbody></table></div><p>An Excel worksheet may look like:</p><div class="table-wrap"><table data-layout="default" data-local-id="f0d145a2-5615-4b9b-b489-38d8330f01b6" class="confluenceTable"><colgroup><col style="width: 226.67px;"/><col style="width: 226.67px;"/><col style="width: 226.67px;"/></colgroup><tbody><tr><th class="confluenceTh"><p /></th><th class="confluenceTh"><p><strong>LAST NAME</strong></p></th><th class="confluenceTh"><p><strong>GENDER</strong></p></th></tr><tr><td data-highlight-colour="transparent" class="confluenceTd"><p>{{!REPEATROW}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p>{{lastname}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p>{{gender}}</p></td></tr></tbody></table></div><p>Remember that you must place the {{!REPEATROW}} placeholder as the very first item in the row!</p><h3 id="RepeatingData-AdvancedUse:Outputtingmultiplerepeatsperrow"><strong>Advanced Use: Outputting multiple repeats per row</strong></h3><p>At times it may be useful to show repeat values side by side in the same row - for example if you have a repeating photo capture page, you might want to put the photos side by side in a 2 or 3 column configuration.</p><p>This is possible by adding some special syntax to the {{!REPEATROW}} placeholder, specifically you must put a pipe character followed by the number of repeats to handle per row.<br/>So for example if you want to have 3 sets of repeated values side by side, then you would use:<br/><strong>{{!REPEATROW|3}}</strong></p><p>Then in the repeated row part of your template, you must specify the desired repeat fields as many times as the number of sets to display. When generated, the answer value from each repeat will be inserted sequentially for each occurrence of the same dataname in the row.</p><p>For example in a Word table:</p><div class="table-wrap"><table data-layout="default" data-local-id="d947b19e-ac13-4d3b-8b66-fae669f5092d" class="confluenceTable"><colgroup><col style="width: 226.67px;"/><col style="width: 226.67px;"/><col style="width: 226.67px;"/></colgroup><tbody><tr><td data-highlight-colour="transparent" class="confluenceTd"><p>{{!REPEATROW|3}}{{photo}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p>{{photo}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p>{{photo}}</p></td></tr></tbody></table></div><p>﻿An Excel worksheet may look like:</p><div class="table-wrap"><table data-layout="default" data-local-id="454f8195-e29b-4a7c-bc66-b92916243bf5" class="confluenceTable"><colgroup><col style="width: 170.0px;"/><col style="width: 170.0px;"/><col style="width: 170.0px;"/><col style="width: 170.0px;"/></colgroup><tbody><tr><td data-highlight-colour="transparent" class="confluenceTd"><p>{{!REPEATROW|3}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p>{{photo}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p>{{photo}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p>{{photo}}</p></td></tr></tbody></table></div><h3 id="RepeatingData-UsingtheRepeatingSectionsApproach"><strong>Using the Repeating Sections Approach</strong></h3><p>With this option you define the placeholders once for the desired fields in a repeatable page group, and enclose these within special {{!REPEATSTART}} and {{!REPEATEND}} placeholders.<br/>For Excel. the system will repeat all rows found between the START and END placeholders.</p><p>This tells the system to repeat everything found within the REPEAT placeholders, including formatting, bullet points, table rows, images, static text etc. When generating output, the system will make a copy of the area within the REPEATs and will replace all regular data name placeholders found within the area, for each repeat of the answers.</p><p>For example, imagine we have a Form with a repeatable set of fields for capturing children:</p><ul><li><p>First Name (data name="firstname")</p></li><li><p>Last Name (data name="lastname")</p></li><li><p>Gender (data name="gender")</p></li></ul><p>You could define a repeatable bullet listing as follows:</p><p>{{!REPEATSTART}}<br/><em>Name:</em>  {{lastname}},  {{firstname}}<br/><em>Gender:</em>  {{gender}}<br/>{{!REPEATEND}}</p><p><strong>Important Note</strong>: Both {{!REPEATSTART}} and {{!REPEATEND}} placeholders must exist on their own rows respectively. </p><h3 id="RepeatingData-AdvancedUse:Outputtingmultiplerepeatspersection"><strong>Advanced Use: Outputting multiple repeats per section</strong></h3><p>At times it may be useful to show repeat values side by side in the same section - for example if you have a repeating photo capture page, you might want to put the photos side by side in a 2 or 3 column configuration, with accompanying captions and other repeated data shown above or underneath each photo.</p><p>This is possible by adding some special syntax to the {{!REPEATSTART}} placeholder, specifically you must put a pipe character followed by the number of repeats to handle per row.<br/>So for example if you want to have 3 sets of repeated values side by side, then you would use:<br/><strong>{{!REPEATSTART|3}}</strong></p><p>Then in the repeated section part of your template, you must specify the desired repeat fields as many times as the number of sets to display. When generated, the answer value from each repeat will be inserted sequentially for each occurrence of the same dataname in the section.</p><p>For example in a Word document:</p><p><strong>Photos</strong></p><p>{{!REPEATSTART|3}}</p><div class="table-wrap"><table data-layout="default" data-local-id="575ffc78-711b-4b44-8754-cedb35a35288" class="confluenceTable"><colgroup><col style="width: 226.67px;"/><col style="width: 226.67px;"/><col style="width: 226.67px;"/></colgroup><tbody><tr><td data-highlight-colour="transparent" class="confluenceTd"><p><strong>Photo Name:</strong> {{photoName}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p><strong>Photo Name:</strong> {{photoName}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p><strong>Photo Name:</strong> {{photoName}}</p></td></tr><tr><td data-highlight-colour="transparent" class="confluenceTd"><p>{{photo}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p>{{photo}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p>{{photo}}</p></td></tr><tr><td data-highlight-colour="transparent" class="confluenceTd"><p>{{photoCaption}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p>{{photoCaption}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p>{{photoCaption}}</p></td></tr></tbody></table></div><p>{{!REPEATEND}}</p><p>﻿An Excel worksheet may look like:</p><div class="table-wrap"><table data-layout="default" data-local-id="295bb3cd-c41f-4de7-b4a4-b11522021507" class="confluenceTable"><colgroup><col style="width: 226.67px;"/><col style="width: 226.67px;"/><col style="width: 226.67px;"/></colgroup><tbody><tr><td data-highlight-colour="transparent" class="confluenceTd"><p>{{!REPEATSTART|3}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p /></td><td data-highlight-colour="transparent" class="confluenceTd"><p /></td></tr><tr><td data-highlight-colour="transparent" class="confluenceTd"><p><strong>Photo Name:</strong> {{photoName}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p><strong>Photo Name:</strong> {{photoName}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p><strong>Photo Name:</strong> {{photoName}}</p></td></tr><tr><td data-highlight-colour="transparent" class="confluenceTd"><p>{{photo}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p>{{photo}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p>{{photo}}</p></td></tr><tr><td data-highlight-colour="transparent" class="confluenceTd"><p>{{photoCaption}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p>{{photoCaption}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p>{{photoCaption}}</p></td></tr><tr><td data-highlight-colour="transparent" class="confluenceTd"><p>{{!REPEATEND}}</p></td><td data-highlight-colour="transparent" class="confluenceTd"><p /></td><td data-highlight-colour="transparent" class="confluenceTd"><p /></td></tr></tbody></table></div><h3 id="RepeatingData-NestedRepeats"><strong>Nested Repeats</strong></h3><p>Unfortunately we don't currently support nested repeats within the template engine. When nested repeats are required, the best option would be to collapse the sections to be repeated. As an example, assume you have a list of buildings, that contain multiple rooms, and these rooms contain multiple items. You could have a repeating page, or a page within a table where the user can choose a building, then a room, and then an item, from three choice fields in the page. The form could use the PRIOR() formula to set the building and room values dynamically to save a user's time by carrying forward the values from one page to the following page.</p><p>We do have plans to include nested repeats within the template engine, but do not yet have a time-frame for when this feature will be implemented.</p><h3 id="RepeatingData-ExamplesofRepeatableTemplates"><strong>Examples of Repeatable Templates</strong></h3><p>Attached is a testing form design, along with data output templates for Word and Excel that will you help understand how the above functionality works.</p><ol><li><p>Download these attachments, then create a new Form in your account.<br/>Go to the Designer page of your new Form, and use the "Import Fields" button to import the Form xlsx file. This will import the testing form design, and you should set the Form to Test mode after importing the fields.</p></li><li><p>Then go to the Settings page of your new Form, and upload the attached Template xlsx and docx files into the Excel and Word Default Template fields respectively.</p></li><li><p>Now open up the Form on your device and capture an entry.  Make sure you capture more than one photo when prompted.<br/>Complete the entry and upload it from your app.</p></li><li><p>Finally, go to the Data page of the secure website and find your entry.  <br/>Mouse over the entry row and click the Export link, then choose one of the Template files to see the output.</p></li></ol><p class="media-group"><span class="confluence-embedded-file-wrapper conf-macro output-inline" data-hasbody="false" data-macro-name="view-file" data-macro-id="0e8a6082-2520-4d15-b721-ff53bee3062d"><a class="confluence-embedded-file" href="/wiki/download/attachments/26522783802/Timesheet_Example_Data_Template.xlsx?version=1&amp;modificationDate=1689148764011&amp;cacheVersion=1&amp;api=v2" data-nice-type="Microsoft Excel Spreadsheet" data-file-src="/wiki/download/attachments/26522783802/Timesheet_Example_Data_Template.xlsx?version=1&amp;modificationDate=1689148764011&amp;cacheVersion=1&amp;api=v2" data-linked-resource-id="26522783814" data-linked-resource-type="attachment" data-linked-resource-container-id="26522783802" data-linked-resource-default-alias="Timesheet_Example_Data_Template.xlsx" data-mime-type="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" data-has-thumbnail="true" data-linked-resource-version="1" data-media-id="ae5cc14e-0135-492c-8274-6c7cfaac8c70" data-media-type="file"><img src="../../../../assets/Outputting Data with Templates/Repeating Data/Timesheet_Example_Data_Template.xlsx" height="250" /></a></span><span class="confluence-embedded-file-wrapper conf-macro output-inline" data-hasbody="false" data-macro-name="view-file" data-macro-id="aafc17f9-07f3-416e-9f00-729dc47d71e4"><a class="confluence-embedded-file" href="/wiki/download/attachments/26522783802/TimeSheet_Example_Form.xlsx?version=1&amp;modificationDate=1689148764122&amp;cacheVersion=1&amp;api=v2" data-nice-type="Microsoft Excel Spreadsheet" data-file-src="/wiki/download/attachments/26522783802/TimeSheet_Example_Form.xlsx?version=1&amp;modificationDate=1689148764122&amp;cacheVersion=1&amp;api=v2" data-linked-resource-id="26522783817" data-linked-resource-type="attachment" data-linked-resource-container-id="26522783802" data-linked-resource-default-alias="TimeSheet_Example_Form.xlsx" data-mime-type="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" data-has-thumbnail="true" data-linked-resource-version="1" data-media-id="2ca29f83-70dd-4ecf-a909-6c6f2c00f3aa" data-media-type="file"><img src="../../../../assets/Outputting Data with Templates/Repeating Data/TimeSheet_Example_Form.xlsx" height="250" /></a></span><span class="confluence-embedded-file-wrapper conf-macro output-inline" data-hasbody="false" data-macro-name="view-file" data-macro-id="fdb4fdfc-4dc2-4b5e-b542-03978e832750"><a class="confluence-embedded-file" href="/wiki/download/attachments/26522783802/Timesheet_Example_Data_Template.docx?version=1&amp;modificationDate=1689148764224&amp;cacheVersion=1&amp;api=v2" data-nice-type="Microsoft Word Document" data-file-src="/wiki/download/attachments/26522783802/Timesheet_Example_Data_Template.docx?version=1&amp;modificationDate=1689148764224&amp;cacheVersion=1&amp;api=v2" data-linked-resource-id="26522783820" data-linked-resource-type="attachment" data-linked-resource-container-id="26522783802" data-linked-resource-default-alias="Timesheet_Example_Data_Template.docx" data-mime-type="application/vnd.openxmlformats-officedocument.wordprocessingml.document" data-has-thumbnail="true" data-linked-resource-version="1" data-media-id="ab56da46-7af5-4767-83ba-7c9b83f88335" data-media-type="file"><img src="../../../../assets/Outputting Data with Templates/Repeating Data/Timesheet_Example_Data_Template.docx" height="250" /></a></span></p><p /><p />